var r={},n=0,e="1.0.0";function t(){}function l(e,a){try{n.postMessage({type:"setLocalStorageKey",data:{key:e,value:a}})}catch(t){self.clients.matchAll({type:"window"}).then(function(t){t.forEach(function(t){t.postMessage({type:"setLocalStorageKey",data:{key:e,value:a}})})})}}function f(e){try{n.postMessage({type:"getLocalStorageKey",data:{key:e}})}catch(t){self.clients.matchAll({type:"window"}).then(function(t){t.forEach(function(t){t.postMessage({type:"getLocalStorageKey",data:{key:e}})})})}}async function a(){try{var t=await(await fetch("/api/articles.json")).json();l("prevs",JSON.stringify(t))}catch(t){}}function u(t){self.registration.showNotification(t.title,{body:"Besuche unseren neuesten Artikel!",data:{url:"/article/"+t.path+".html"}})}async function s(){try{var t=await(await fetch("/api/articles.json")).json(),e=[];try{f("subs"),e=JSON.parse(r.subs)}catch(t){}var a=[];try{f("prevs"),a=JSON.parse(r.prevs)}catch(t){}for(var n=0;n<e.length;n++)for(var s=t[e[n]],i=a[e[n]],c=s.filter(function(e){return!i.some(function(t){return e.path===t.path})}),o=0;o<c.length;o++)u(c[o]);l("prevs",JSON.stringify(t))}catch(t){}}self.addEventListener("install",function(t){t.waitUntil(caches.open(e).then(function(t){return t.addAll(["","/","/index.html","/assets/styles/article.css","/assets/styles/main.css","/assets/scripts/audio-player.js","/assets/scripts/layout.js","/assets/scripts/graph.js"])}))}),self.addEventListener("activate",function(t){t.waitUntil(caches.keys().then(function(t){return Promise.all(t.map(function(t){if(t!==e)return caches.delete(t)}))})),t.waitUntil(caches.delete("static-test")),t.waitUntil(self.clients.claim())}),self.addEventListener("fetch",function(e){e.respondWith(caches.match(e.request).then(function(t){return t||fetch(e.request)}))}),self.addEventListener("notificationclick",function(e){e.notification.close();try{e.waitUntil(n.navigate(e.notification.data.url))}catch(t){e.waitUntil(clients.matchAll({type:"window"}).then(function(t){return 0<t.length?(t[0].navigate(e.notification.data.url),t[0].focus()):clients.openWindow(e.notification.data.url)}))}}),self.addEventListener("message",function(t){"localStorageData"===t.data.type?r=t.data.data:"setLocalStorageKeyB"===t.data.type||"getLocalStorageKeyB"===t.data.type?r[t.data.data.key]=t.data.data.value:"init"===t.data.type&&(n=t.source)}),a(),setInterval(s,1e4);